# xoxa-msg

<img src="./assets/banner.png" width="300" alt="banner"/>

A TypeScript-first, multi-platform messaging SDK for **SMS**, **WhatsApp**, and **Telegram**, built with developer speed in mind.

## üì≤ What is xoxa-msg?

**xoxa-msg** is a class-based, strongly typed messaging library that gives you a single API to send messages across multiple providers. No need to juggle three different APIs ‚Äî this package serves as a wrapper that unifies them.

‚úÖ SMS via **Twilio**  
‚úÖ WhatsApp via **Meta's WhatsApp Cloud API**  
‚úÖ Telegram via **Bot API**

Supports:

- Media attachments
- Typed delivery receipts
- Retry with exponential backoff
- Full OOP and TypeScript typing
- Pluggable transports
- Form encoding support for Twilio

---

## üì¶ Installation

```bash
npm install xoxa-msg
```

---

## üìÇ Folder Structure

```bash
src/
‚îú‚îÄ‚îÄ core/            # Core logic (XoxaClient, Events, Errors)
‚îú‚îÄ‚îÄ types/           # Reusable types (message, config)
‚îú‚îÄ‚îÄ interfaces/      # Logger + Transport interfaces
‚îú‚îÄ‚îÄ transports/      # Twilio, WhatsApp, Telegram classes
‚îú‚îÄ‚îÄ utilities/       # HTTP, form encoding, logger
‚îú‚îÄ‚îÄ dtos/            # Normalized message/delivery DTOs
‚îî‚îÄ‚îÄ constants/       # Defaults, channel enums
```

---

## üßë‚Äçüíª Example Usage

### SMS (Via Twilio)
```ts
// tested on an isolated index.ts file
import { TwilioSmsTransport, XoxaClient } from "xoxa-msg";
import * as dotenv from "dotenv";
dotenv.config();
(async () => {
  const client = new XoxaClient({ appId: "xoxa-app", debug: true });
  client.registerTransport(
    new TwilioSmsTransport({
      accountSid: process.env.TWILIO_SID!,
      authToken: process.env.TWILIO_TOKEN!,
    })
  );

  await client.connect();

  await client.send({
    channel: "sms",
    to: "+00000000000",
    body: "Hello from Durban! üáøüá¶",
    from: "+00000000001",
  });

  await client.disconnect();
})();

```

```ts
import { XoxaClient, TwilioSmsTransport, WhatsAppTransport, TelegramTransport } from "xoxa-msg";

const client = new XoxaClient({ appId: "xoxa-app", debug: true });

// Register SMS (Twilio)
client.registerTransport(
    new TwilioSmsTransport({
        accountSid: process.env.TWILIO_SID!,
        authToken: process.env.TWILIO_TOKEN!,
        from: process.env.TWILIO_FROM!,
    }),
);

// Register WhatsApp (Meta)
client.registerTransport(
    new WhatsAppTransport({
        accessToken: process.env.WHATSAPP_TOKEN!,
        phoneNumberId: process.env.WHATSAPP_NUMBER_ID!,
    }),
);

// Register Telegram
client.registerTransport(
    new TelegramTransport({
        botToken: process.env.TELEGRAM_BOT_TOKEN!,
    }),
);

await client.connect();

// Send SMS
await client.send({
    channel: "sms",
    to: "+2783XXXXXXX",
    body: "Hello from Durban! üáøüá¶",
});

// Send WhatsApp with image
await client.send({
    channel: "whatsapp",
    to: "+2783XXXXXXX",
    body: "Check this out!",
    media: [
        {
            kind: "image",
            url: "https://example.com/dog.jpg",
            caption: "Here‚Äôs my dog üê∂",
        },
    ],
});

// Send Telegram text
await client.send({
    channel: "telegram",
    to: "123456789",
    body: "Yo, from xoxa!",
});

await client.disconnect();
```
